---
/**
 * ProjectShowcase Component
 *
 * Featured projects grid with project cards displaying tech stack and descriptions.
 * Designed for homepage and projects page.
 *
 * @component
 */

import Card from '@components/ui/Card.astro';
import Badge from '@components/ui/Badge.astro';
import Button from '@components/ui/Button.astro';
import Container from '@components/ui/Container.astro';

interface Project {
  title: string;
  description: string;
  techStack: string[];
  href?: string;
  github?: string;
  featured?: boolean;
}

interface Props {
  /** Array of projects to display */
  projects?: Project[];
  /** Section title */
  title?: string;
  /** Section description */
  description?: string;
  /** Show "View All" button */
  showViewAll?: boolean;
  /** View all link */
  viewAllHref?: string;
}

const {
  projects = [],
  title = 'Featured Projects',
  description = 'A selection of my recent work in data science, machine learning, and software engineering.',
  showViewAll = true,
  viewAllHref = '/projects',
} = Astro.props;

// Default projects if none provided
const defaultProjects: Project[] = [
  {
    title: 'High-Performance ML Pipeline',
    description: 'Built a distributed ML training pipeline in Rust, achieving 10x faster processing compared to Python alternatives. Handles real-time data streams with sub-millisecond latency.',
    techStack: ['Rust', 'Apache Arrow', 'TensorFlow', 'Docker'],
    featured: true,
  },
  {
    title: 'Julia Optimization Framework',
    description: 'Developed a scientific computing framework for large-scale numerical optimization. Used in production by multiple research institutions.',
    techStack: ['Julia', 'CUDA', 'Linear Algebra', 'HPC'],
  },
  {
    title: 'AI-Powered Analytics Platform',
    description: 'End-to-end analytics platform with automated ML model deployment, A/B testing, and real-time dashboards. Serves 1M+ requests daily.',
    techStack: ['Python', 'FastAPI', 'PostgreSQL', 'React'],
  },
];

const displayProjects = projects.length > 0 ? projects : defaultProjects;
---

<section class="section project-showcase">
  <Container maxWidth="xl" paddingY="lg">
    <!-- Section Header -->
    <div class="section-header">
      <h2 class="section-title">{title}</h2>
      <p class="section-description">{description}</p>
    </div>

    <!-- Projects Grid -->
    <div class="projects-grid">
      {displayProjects.map((project) => (
        <Card
          variant={project.featured ? 'accented' : 'default'}
          hover={true}
          padding="lg"
          href={project.href}
        >
          <div class="project-card-content">
            {/* Featured Badge */}
            {project.featured && (
              <div class="project-featured-badge">
                <Badge variant="warning" size="sm">Featured</Badge>
              </div>
            )}

            {/* Project Title */}
            <h3 class="project-title">{project.title}</h3>

            {/* Project Description */}
            <p class="project-description">{project.description}</p>

            {/* Tech Stack */}
            <div class="project-tech-stack">
              {project.techStack.map((tech) => (
                <Badge size="sm">{tech}</Badge>
              ))}
            </div>

            {/* Links */}
            <div class="project-links">
              {project.href && (
                <a href={project.href} class="project-link" target="_blank" rel="noopener noreferrer">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                  </svg>
                  <span>View Project</span>
                </a>
              )}
              {project.github && (
                <a href={project.github} class="project-link" target="_blank" rel="noopener noreferrer">
                  <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                    <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd" />
                  </svg>
                  <span>Source Code</span>
                </a>
              )}
            </div>
          </div>
        </Card>
      ))}
    </div>

    <!-- View All Button -->
    {showViewAll && (
      <div class="section-cta">
        <Button variant="secondary" size="lg" href={viewAllHref}>
          View All Projects
          <svg class="ml-2 -mr-1 w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
          </svg>
        </Button>
      </div>
    )}
  </Container>
</section>

<style>
  .project-showcase {
    @apply bg-light-bg dark:bg-dark-bg;
  }

  /* Section Header */
  .section-header {
    @apply text-center mb-12 md:mb-16;
  }

  .section-title {
    @apply text-3xl md:text-4xl lg:text-5xl;
    @apply font-bold mb-4;
    @apply text-text-primary-light dark:text-text-primary-dark;
  }

  .section-description {
    @apply text-lg md:text-xl;
    @apply text-text-secondary-light dark:text-text-secondary-dark;
    @apply max-w-3xl mx-auto;
  }

  /* Projects Grid */
  .projects-grid {
    @apply grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8;
  }

  /* Project Card */
  .project-card-content {
    @apply flex flex-col h-full;
  }

  .project-featured-badge {
    @apply mb-4;
  }

  .project-title {
    @apply text-xl md:text-2xl font-semibold mb-3;
    @apply text-text-primary-light dark:text-text-primary-dark;
  }

  .project-description {
    @apply text-text-secondary-light dark:text-text-secondary-dark;
    @apply mb-4 flex-grow;
    line-height: 1.6;
  }

  .project-tech-stack {
    @apply flex flex-wrap gap-2 mb-4;
  }

  .project-links {
    @apply flex flex-wrap gap-4 pt-4;
    @apply border-t border-light-border dark:border-dark-border;
  }

  .project-link {
    @apply inline-flex items-center gap-2;
    @apply text-sm font-medium;
    @apply text-eucalyptus-700 dark:text-eucalyptus-300;
    @apply hover:text-eucalyptus-600 dark:hover:text-eucalyptus-200;
    @apply transition-colors duration-150;
    @apply  rounded;
    &:focus-visible { outline: none; ring: 2px solid; ring-color: theme('colors.eucalyptus.500'); ring-offset: 2px; }
  }

  /* Section CTA */
  .section-cta {
    @apply flex justify-center mt-12;
  }
</style>
